#N canvas 566 0 934 1028 12;
#X obj 14 12 cnv 19 900 45 empty empty WitMotion\ BWT901CL\ Message\ Decoder 3 12 0 18 #606060 #ffffff 0;
#X text 497 67 This Patch requires the following libraries to be installed via DEKEN \; - comport \; - zexy;
#X text 798 39 Peter Venus 2023;
#X obj 13 243 cnv 19 900 400 empty empty recieve\ messages\ from\ sensor/\ create\ list\ from\ every\ new\ message 2 12 0 12 #e0e0e0 #404040 0;
#X obj 187 307 comport 6 115200;
#X obj 44 385 spigot 0;
#X obj 44 307 tgl 19 0 empty empty print\ incoming\ msg 0 -10 0 12 #faff00 #000000 #000000 0 1;
#X obj 187 389 sel 85;
#X obj 226 445 list prepend;
#X obj 366 474 t l;
#X text 570 504 2nd byte defines msg-role \; 83 == angle (Roll/Pitch/Yaw) \; 84 == magnetic out(X/Y/Z) \; 89 == Quaternion (q1 \, q2 \, q3 \, q4);
#X listbox 389 573 72 0 0 0 - - - 0;
#X text 366 438 create lists from stream of numbers until "85" starts new msg \;;
#X obj 226 502 route 83 89, f 47;
#N canvas 235 143 552 638 tester 0;
#X obj 20 94 inlet;
#X obj 20 560 outlet;
#X msg 20 133 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 124 255 237 0 70 139 154 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139 153 85 83 151 255 20 0 113 162 248 71 164 85 89 127 52 123 255 237 0 70 139;
#X obj 20 536 drip 100;
#X text 19 53 This subpatch simulates a stream of data received by the sensor \;;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 723 307 pd tester with zexy/drip;
#X obj 44 409 print COM;
#X obj 723 281 bng 19 250 50 0 empty empty message\ tester 25 12 0 12 #ff8300 #000000 #000000;
#X text 244 390 "85" starts new line/every new msg Starts with 0x55(85);
#X obj 13 652 cnv 19 900 330 empty empty create\ useful\ messages\ out\ of\ the\ incoming\ data\ for\ further\ use 2 12 0 12 #c6ffc7 #404040 0;
#X obj 226 576 send \$0-angle;
#X obj 44 679 r \$0-angle;
#X listbox 44 703 47 0 0 0 - - - 0;
#X obj 44 751 list length;
#X obj 44 726 t l l;
#X obj 44 775 == 9;
#X obj 44 833 list;
#X obj 44 799 sel 1;
#X msg 344 881 \$5 \$6;
#X obj 344 930 / 32768;
#X obj 194 930 / 32768;
#X msg 194 881 \$3 \$4;
#X obj 344 906 expr (($f2<<8)|$f1);
#X obj 194 906 expr (($f2<<8)|$f1);
#X obj 44 930 / 32768;
#X obj 44 906 expr (($f2<<8)|$f1);
#X msg 44 881 \$1 \$2;
#X obj 44 954 * 180;
#X obj 194 954 * 180;
#X obj 344 954 * 180;
#X text 92 772 as new msg need to "build up" from a single element to their full length (9 in this case) \, the full msg will only be forwarded \, if length == 9 is true;
#X obj 509 906 cnv 19 360 20 empty empty expr-calculations\ according\ to\ sensor\ documentation 2 12 0 12 #ffe3c6 #000000 0;
#X obj 12 993 cnv 19 900 100 empty empty empty 20 12 0 12 #ffe3c6 #404040 0;
#X floatatom 342 1061 5 0 0 3 YAW/Z - - 0;
#X floatatom 193 1061 5 0 0 3 Pitch/Y - - 0;
#X floatatom 44 1061 5 0 0 3 Roll/X - - 0;
#N canvas 571 377 999 311 reset 0;
#X obj 39 42 inlet;
#X obj 238 44 inlet;
#X obj 463 43 inlet;
#X obj 511 117 f;
#X obj 468 90 t f f;
#X obj 468 141 - 0;
#X obj 468 212 wrap;
#X obj 468 266 - 180;
#X obj 468 188 / 360;
#X obj 468 236 * 360;
#X obj 468 164 - 180;
#X obj 511 67 r \$0-rst-angl;
#X obj 468 290 outlet;
#X obj 281 117 f;
#X obj 238 90 t f f;
#X obj 238 141 - 0;
#X obj 238 212 wrap;
#X obj 238 188 / 360;
#X obj 238 236 * 360;
#X obj 281 67 r \$0-rst-angl;
#X obj 238 290 outlet;
#X obj 81 127 f;
#X obj 38 100 t f f;
#X obj 38 151 - 0;
#X obj 38 222 wrap;
#X obj 38 198 / 360;
#X obj 38 246 * 360;
#X obj 81 77 r \$0-rst-angl;
#X obj 38 300 outlet;
#X obj 38 174 - 180;
#X obj 38 276 - 180;
#X obj 238 266 - 180;
#X obj 238 164 - 180;
#X connect 0 0 22 0;
#X connect 1 0 14 0;
#X connect 2 0 4 0;
#X connect 3 0 5 1;
#X connect 4 0 5 0;
#X connect 4 1 3 1;
#X connect 5 0 10 0;
#X connect 6 0 9 0;
#X connect 7 0 12 0;
#X connect 8 0 6 0;
#X connect 9 0 7 0;
#X connect 10 0 8 0;
#X connect 11 0 3 0;
#X connect 13 0 15 1;
#X connect 14 0 15 0;
#X connect 14 1 13 1;
#X connect 15 0 32 0;
#X connect 16 0 18 0;
#X connect 17 0 16 0;
#X connect 18 0 31 0;
#X connect 19 0 13 0;
#X connect 21 0 23 1;
#X connect 22 0 23 0;
#X connect 22 1 21 1;
#X connect 23 0 29 0;
#X connect 24 0 26 0;
#X connect 25 0 24 0;
#X connect 26 0 30 0;
#X connect 27 0 21 0;
#X connect 29 0 25 0;
#X connect 30 0 28 0;
#X connect 31 0 20 0;
#X connect 32 0 17 0;
#X restore 44 1012 pd reset axis mechanism subpatch;
#X f 43;
#X obj 775 1012 bng 20 250 50 0 empty empty RESET\ ANGLE 22 10 0 16 #00ff04 #000000 #000000;
#X obj 775 1036 s \$0-rst-angl;
#X text 782 1055 reset angle \; locally;
#X text 148 832 the first 6 elements of the list carry the necessary information to retreive the angles;
#X obj 409 307 send \$0-cmd;
#X obj 187 281 receive \$0-cmd;
#X msg 409 281 devices;
#X msg 479 281 open 6;
#X msg 559 281 baud 115200;
#X text 12 66 This Patch documents a possible solution to decode the messages sent from a WItMotion BWT901 Bluetooth 9-DOF sensor \; Settings to the sensor like Baudrate and type of transmitted messages have to be done (so far) with the MiniMU software provided by WitMotion \; Information on the available messages can be found in the BWT901CL_Datasheet.pdf file provided with the software by WitMotion \; At the time of writing sensor documentation can be found at https://www.wit-motion.com/9-axis/wt901blecl-mpu9250-high-precision.html;
#X connect 4 0 5 0;
#X connect 4 0 7 0;
#X connect 5 0 15 0;
#X connect 6 0 5 1;
#X connect 7 0 8 1;
#X connect 7 1 8 0;
#X connect 8 0 9 0;
#X connect 8 0 13 0;
#X connect 9 0 8 1;
#X connect 13 0 19 0;
#X connect 13 1 11 0;
#X connect 14 0 7 0;
#X connect 16 0 14 0;
#X connect 20 0 21 0;
#X connect 21 0 23 0;
#X connect 22 0 24 0;
#X connect 23 0 22 0;
#X connect 23 1 25 1;
#X connect 24 0 26 0;
#X connect 25 0 27 0;
#X connect 25 0 30 0;
#X connect 25 0 35 0;
#X connect 26 0 25 0;
#X connect 27 0 31 0;
#X connect 28 0 38 0;
#X connect 29 0 37 0;
#X connect 30 0 32 0;
#X connect 31 0 28 0;
#X connect 32 0 29 0;
#X connect 33 0 36 0;
#X connect 34 0 33 0;
#X connect 35 0 34 0;
#X connect 36 0 45 0;
#X connect 37 0 45 1;
#X connect 38 0 45 2;
#X connect 45 0 44 0;
#X connect 45 1 43 0;
#X connect 45 2 42 0;
#X connect 46 0 47 0;
#X connect 51 0 4 0;
#X connect 52 0 50 0;
#X connect 53 0 50 0;
#X connect 54 0 50 0;
